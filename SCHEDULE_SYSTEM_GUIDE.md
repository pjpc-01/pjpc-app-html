# 排班管理系统使用指南

## 🎯 系统概述

排班管理系统已经完全集成到您的Flutter应用中，与考勤、薪资、请假系统完全关联。系统支持教师排班的创建、编辑、删除和查看，并提供智能的班次冲突检测。现在还包括了强大的排班模板管理功能！

## 📍 入口位置

### 管理员入口
1. **主页面** → 管理员工作台
2. 找到 **"排班管理"** 卡片（蓝色图标，第三行第一个）
3. 点击进入排班管理界面

### 综合报表入口
1. **主页面** → 管理员工作台
2. 找到 **"综合报表"** 卡片（粉色图标，第三行第二个）
3. 可以查看考勤、排班、薪资、请假的综合数据

## 🚀 功能特性

### 1. 排班管理
- ✅ **创建排班**：为教师安排具体日期和时间的工作班次
- ✅ **编辑排班**：修改现有排班的时间、地点、状态等
- ✅ **删除排班**：移除不需要的排班记录
- ✅ **状态管理**：支持"已排班"、"已确认"、"进行中"状态
- ✅ **类型分类**：支持"全职"、"兼职"、"仅教学"类型

### 2. 排班模板管理 🆕
- ✅ **创建模板**：创建可重复使用的排班模板
- ✅ **编辑模板**：修改模板的工作时间、天数等设置
- ✅ **删除模板**：移除不需要的模板
- ✅ **模板分类**：按类型和状态管理模板
- ✅ **工作天数配置**：灵活设置每周工作天数
- ✅ **颜色标识**：为不同模板设置不同颜色

### 3. 智能筛选
- 🔍 **按状态筛选**：查看特定状态的排班
- 🔍 **按类型筛选**：查看特定类型的排班
- 🔍 **按教师筛选**：查看特定教师的排班
- 🔍 **按日期筛选**：查看特定日期的排班

### 4. 数据展示
- 📊 **列表视图**：清晰的排班记录列表
- 📊 **状态标签**：不同颜色标识不同状态
- 📊 **类型标签**：区分不同的排班类型
- 📊 **详细信息**：显示教师、时间、地点、时薪等

## 🛠️ 使用方法

### 排班管理

#### 添加新排班
1. 进入排班管理界面
2. 点击右上角的 **"+"** 按钮
3. 填写排班信息：
   - **选择教师**：从下拉列表选择
   - **选择班级**：可选，关联特定班级
   - **选择日期**：点击日期选择器
   - **选择时间**：设置开始和结束时间
   - **选择状态**：已排班/已确认/进行中
   - **选择类型**：全职/兼职/仅教学
   - **填写地点**：中心/房间信息
   - **设置时薪**：可选，用于薪资计算
   - **设置加班**：标记是否为加班班次
4. 点击 **"保存排班"** 完成创建

#### 编辑排班
1. 在排班列表中点击要编辑的记录
2. 点击 **"编辑"** 按钮（铅笔图标）
3. 修改需要的信息
4. 点击 **"保存排班"** 完成更新

#### 删除排班
1. 在排班列表中点击要删除的记录
2. 点击 **"删除"** 按钮（垃圾桶图标）
3. 确认删除操作

### 排班模板管理 🆕

#### 访问模板管理
1. 进入排班管理界面
2. 点击右上角的 **"📅"** 按钮（排班模板图标）
3. 进入排班模板管理界面

#### 创建新模板
1. 在模板管理界面点击右上角的 **"+"** 按钮
2. 填写模板信息：
   - **模板名称**：输入模板名称
   - **模板类型**：选择全职/兼职/仅教学
   - **工作天数**：选择每周工作天数（星期一到星期日）
   - **工作时间**：设置开始和结束时间
   - **最大工作时长**：设置每周最大工作小时数
   - **模板颜色**：选择模板标识颜色
   - **启用状态**：设置模板是否启用
3. 点击 **"保存模板"** 完成创建

#### 编辑模板
1. 在模板列表中点击要编辑的模板
2. 点击 **"编辑"** 按钮（铅笔图标）
3. 修改需要的信息
4. 点击 **"保存模板"** 完成更新

#### 删除模板
1. 在模板列表中点击要删除的模板
2. 点击 **"删除"** 按钮（垃圾桶图标）
3. 确认删除操作

## 🔗 系统集成

### 与考勤系统关联
- 排班记录为考勤系统提供工作时间基准
- 考勤数据影响薪资计算
- 支持工作时长统计和加班检测

### 与薪资系统关联
- 排班记录中的时薪信息用于薪资计算
- 加班班次影响薪资结构
- 工作时长直接影响月薪计算

### 与请假系统关联
- 请假记录影响排班安排
- 无薪假会扣除相应排班薪资
- 排班冲突检测考虑请假情况

## 📊 数据字段说明

### 排班记录字段
- **teacher_id**: 教师ID（关联teachers表）
- **class_id**: 班级ID（可选，关联classes表）
- **date**: 排班日期
- **start_time**: 开始时间（HH:MM格式）
- **end_time**: 结束时间（HH:MM格式）
- **center**: 中心/地点
- **room**: 房间/教室
- **status**: 状态（scheduled/confirmed/in_progress）
- **is_overtime**: 是否加班
- **hourly_rate**: 时薪（RM）
- **total_hours**: 总工作时长（小时）
- **schedule_type**: 排班类型（fulltime/parttime/teaching_only）

### 排班模板字段 🆕
- **name**: 模板名称
- **type**: 模板类型（fulltime/parttime/teaching_only）
- **work_days**: 工作天数配置（JSON格式）
- **start_time**: 开始时间（HH:MM格式）
- **end_time**: 结束时间（HH:MM格式）
- **max_hours_per_week**: 每周最大工作时长（小时）
- **color**: 模板颜色（十六进制）
- **is_active**: 是否启用

## 🎨 界面特色

### 现代化设计
- 卡片式布局，清晰易读
- 状态和类型用彩色标签区分
- 响应式设计，适配不同屏幕

### 用户友好
- 直观的图标和按钮
- 清晰的错误提示
- 流畅的加载动画

### 数据安全
- 完整的错误处理
- 数据验证和空值检查
- 安全的API调用

## 🔧 故障排除

### 常见问题
1. **加载失败**：检查网络连接和数据库状态
2. **数据不显示**：确认数据库表已创建
3. **保存失败**：检查必填字段是否完整

### 错误处理
- 系统会自动显示友好的错误信息
- 提供重试按钮重新加载数据
- 详细的错误日志帮助调试

## 🎉 总结

排班管理系统现在已经完全集成到您的应用中，提供了完整的排班管理和模板管理功能。系统与考勤、薪资、请假模块紧密关联，实现了人力资源管理的全面自动化。

**主要优势：**
- ✅ 完整的CRUD操作（排班 + 模板）
- ✅ 智能筛选和搜索
- ✅ 与其他模块深度集成
- ✅ 现代化用户界面
- ✅ 强大的错误处理
- ✅ 数据安全和验证
- ✅ 模板化排班管理 🆕

**新增功能亮点：**
- 🆕 排班模板管理，提高排班效率
- 🆕 灵活的工作天数配置
- 🆕 模板颜色标识，便于区分
- 🆕 模板状态管理，支持启用/禁用

现在您可以开始使用排班管理系统和模板管理功能来高效管理教师的排班安排了！🎊
