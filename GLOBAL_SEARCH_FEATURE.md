# 全局搜索功能

## 概述

全局搜索功能允许用户在整个系统中快速查找学生、费用、发票、收据、提醒等各种数据。该功能基于学生管理界面的筛选功能设计，提供了更强大的搜索能力。

## 功能特性

### 1. 智能搜索
- **多字段搜索**：支持按姓名、学号、年级、中心等字段搜索学生
- **财务数据搜索**：支持搜索费用、发票、收据、付款等财务信息
- **提醒搜索**：支持搜索各种提醒和通知
- **智能建议**：输入时提供实时搜索建议

### 2. 搜索范围
- **学生管理**：姓名、学号、年级、中心、家长姓名
- **费用管理**：费用名称、类别、描述、金额
- **发票管理**：发票号码、学生姓名、状态、金额
- **收据管理**：收据号码、学生姓名、发票号码
- **提醒管理**：提醒标题、学生姓名、类型
- **付款管理**：付款号码、学生姓名、付款方式

### 3. 快速筛选
- **学生筛选**：所有学生、小学生、中学生、新生
- **财务筛选**：待处理发票、逾期发票、最近付款、费用项目
- **通知筛选**：活跃提醒、今日提醒、已完成提醒
- **时间筛选**：最近活动、本周、本月

### 4. 用户体验
- **搜索历史**：自动保存最近搜索记录
- **键盘快捷键**：Ctrl+K / Cmd+K 快速打开搜索
- **实时结果**：输入时实时显示搜索结果
- **结果统计**：显示各类型结果的数量统计

## 使用方法

### 1. 主页搜索
- 在主页头部找到搜索框
- 点击搜索框或使用快捷键 Ctrl+K / Cmd+K
- 输入搜索关键词
- 选择搜索结果跳转到相应页面

### 2. 搜索页面
- 访问 `/search` 页面获得完整搜索体验
- 使用左侧筛选面板快速筛选数据
- 查看搜索统计和提示信息

### 3. 搜索技巧
- **精确搜索**：输入完整的学生姓名或学号
- **模糊搜索**：输入部分关键词进行模糊匹配
- **分类搜索**：使用快速筛选按钮按类别搜索
- **组合搜索**：结合多个筛选条件进行精确搜索

## 技术实现

### 组件结构
```
app/components/shared/
├── GlobalSearch.tsx          # 全局搜索组件
├── QuickGlobalFilters.tsx    # 快速筛选组件
└── index.ts                  # 组件导出

app/search/
└── page.tsx                  # 搜索页面
```

### 数据源
- `useStudents` - 学生数据
- `useFees` - 费用数据
- `useInvoices` - 发票数据
- `useReceipts` - 收据数据
- `useReminders` - 提醒数据
- `usePayments` - 付款数据

### 搜索算法
- **评分系统**：根据匹配字段的重要程度给结果评分
- **模糊匹配**：支持部分关键词匹配
- **结果排序**：按评分高低排序显示结果
- **结果限制**：最多显示20个结果

## 配置选项

### 搜索权重
- 姓名匹配：10分
- 学号/ID匹配：8分
- 年级/类别匹配：5分
- 描述匹配：3分

### 结果限制
- 搜索建议：最多8个
- 搜索结果：最多20个
- 搜索历史：最多5个

## 未来改进

### 计划功能
- [ ] 高级搜索语法支持
- [ ] 搜索结果导出
- [ ] 搜索过滤器保存
- [ ] 搜索结果分页
- [ ] 搜索性能优化

### 用户体验改进
- [ ] 搜索动画效果
- [ ] 搜索结果预览
- [ ] 搜索建议优化
- [ ] 移动端适配优化

## 注意事项

1. **数据权限**：搜索结果基于用户权限显示
2. **性能考虑**：大量数据时搜索可能需要时间
3. **网络依赖**：需要连接PocketBase服务器
4. **浏览器兼容**：支持现代浏览器

## 故障排除

### 常见问题
1. **搜索无结果**：检查网络连接和数据权限
2. **搜索缓慢**：检查数据量和网络状况
3. **快捷键不工作**：检查浏览器兼容性
4. **建议不显示**：检查数据源是否正常

### 调试方法
1. 打开浏览器开发者工具
2. 查看控制台错误信息
3. 检查网络请求状态
4. 验证数据源连接
